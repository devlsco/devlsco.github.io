{"version":3,"file":"static/js/419.71f56c07.chunk.js","mappings":"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","sources":["views/marathon/modding/index.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { BasicPubSubClient } from '@twurple/pubsub';\r\nimport { ChatClient } from '@twurple/chat';\r\n\r\nconst client = new ChatClient({ channels: [new URLSearchParams(window.location.search).get('login')] });\r\nconst pubsub = new BasicPubSubClient();\r\n\r\nfunction format(number) {\r\n  return number.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.');\r\n}\r\n\r\nconst getChannels = async (login, id) => {\r\n  const request = await fetch('https://api.modscanner.com/twitch/user/' + login);\r\n\r\n  if (!request.ok) return [];\r\n\r\n  const data = await request.json();\r\n\r\n  return [...data.moderating.map((i) => i.id), id];\r\n};\r\n\r\nconst URLParams = new URLSearchParams(window.location.search);\r\n\r\nconst Page = () => {\r\n  const [moderationAction, setModerationAction] = useState(localStorage.getItem('marathon_moderation_action') ?? 0);\r\n  const [moderationActionTotal, setModerationActionTotal] = useState(localStorage.getItem('marathon_moderation_action_total') ?? 0);\r\n  const [moderationActionNeed, setModerationActionNeed] = useState(localStorage.getItem('marathon_moderation_action_need') ?? 0);\r\n  const [currentSubCount, setCurrentSubCount] = useState(localStorage.getItem('marathon_subs') ?? 0);\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      document.title = 'LsCo Software - Modding Marathon';\r\n      document.body.style.backgroundColor = 'initial !important';\r\n\r\n      const authToken = new URLSearchParams(window.location.search).get('access_token');\r\n      const username = new URLSearchParams(window.location.search).get('login');\r\n      const userID = new URLSearchParams(window.location.search).get('id');\r\n      const channels = await getChannels(username, userID);\r\n\r\n      const topics = channels.map((i) => `chat_moderator_actions.${userID}.${i}`);\r\n\r\n      pubsub.onDisconnect((isError, reason) => {\r\n        console.log('[PubSub] Disconnected', reason);\r\n      });\r\n\r\n      pubsub.onListenError((topic, error) => {\r\n        console.error(`[PubSub] An error has occurred on topic '${topic}':`, error);\r\n      });\r\n\r\n      pubsub.onConnect(async () => {\r\n        console.log('[PubSub] Connected');\r\n        await pubsub.listen(topics, authToken);\r\n      });\r\n\r\n      pubsub.onMessage(async (topic, message) => {\r\n        if (topic.split('.').shift() === 'chat_moderator_actions') {\r\n          if (message.data.created_by_user_id === userID) {\r\n            switch (message.data.moderation_action) {\r\n              case 'delete':\r\n              case 'timeout':\r\n              case 'ban': {\r\n                const currentActionCount = Number(localStorage.getItem('marathon_moderation_action')) + 1;\r\n                const currentActionCountTotal = Number(localStorage.getItem('marathon_moderation_action_total')) + 1;\r\n                localStorage.setItem('marathon_moderation_action', currentActionCount);\r\n                localStorage.setItem('marathon_moderation_action_total', currentActionCountTotal);\r\n                setModerationAction(currentActionCount);\r\n                setModerationActionTotal(currentActionCountTotal);\r\n                break;\r\n              }\r\n              default:\r\n                break;\r\n            }\r\n          }\r\n        }\r\n      });\r\n\r\n      client.onSub(() => {\r\n        const currentSubCount = Number(localStorage.getItem('marathon_subs')) + 1;\r\n        localStorage.setItem('marathon_subs', currentSubCount);\r\n        setCurrentSubCount(currentSubCount);\r\n\r\n        const actionNeed = Number(localStorage.getItem('marathon_moderation_action_need')) + URLParams.get('countup') ?? 5;\r\n        localStorage.setItem('marathon_moderation_action_need', actionNeed);\r\n        setModerationActionNeed(actionNeed);\r\n      });\r\n\r\n      client.onResub(() => {\r\n        const currentSubCount = Number(localStorage.getItem('marathon_subs')) + 1;\r\n        localStorage.setItem('marathon_subs', currentSubCount);\r\n        setCurrentSubCount(currentSubCount);\r\n\r\n        const actionNeed = Number(localStorage.getItem('marathon_moderation_action_need')) + URLParams.get('countup') ?? 5;\r\n        localStorage.setItem('marathon_moderation_action_need', actionNeed);\r\n        setModerationActionNeed(actionNeed);\r\n      });\r\n\r\n      client.onSubGift(() => {\r\n        const currentSubCount = Number(localStorage.getItem('marathon_subs')) + 1;\r\n        localStorage.setItem('marathon_subs', currentSubCount);\r\n        setCurrentSubCount(currentSubCount);\r\n\r\n        const actionNeed = Number(localStorage.getItem('marathon_moderation_action_need')) + URLParams.get('countup') ?? 5;\r\n        localStorage.setItem('marathon_moderation_action_need', actionNeed);\r\n        setModerationActionNeed(actionNeed);\r\n      });\r\n\r\n      pubsub.connect();\r\n      client.connect();\r\n\r\n      return () => {\r\n        pubsub.disconnect();\r\n        client.disconnect();\r\n      };\r\n    }\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        fontFamily: 'Comic Neue',\r\n        fontSize: 'xx-large',\r\n        textAlign: 'end',\r\n        verticalAlign: 'middle',\r\n        textShadow: '4px 4px 6px rgba(0, 0, 0, 0.4)',\r\n        margin: '2.5rem'\r\n      }}\r\n    >\r\n      Subs: <peg>{format(currentSubCount)}</peg> - Mod Actions: {format(moderationAction)}/{format(Number(moderationActionNeed))} - Total:{' '}\r\n      {format(moderationActionTotal)}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Page;\r\n"],"names":["client","ChatClient","channels","URLSearchParams","window","location","search","get","pubsub","BasicPubSubClient","format","number","toString","replace","URLParams","Page","_localStorage$getItem","_localStorage$getItem2","_localStorage$getItem3","_localStorage$getItem4","moderationAction","setModerationAction","useState","localStorage","getItem","moderationActionTotal","setModerationActionTotal","moderationActionNeed","setModerationActionNeed","currentSubCount","setCurrentSubCount","useEffect","async","document","title","body","style","backgroundColor","authToken","username","userID","topics","login","id","request","fetch","ok","json","moderating","map","i","getChannels","onDisconnect","isError","reason","console","log","onListenError","topic","error","onConnect","listen","onMessage","message","split","shift","data","created_by_user_id","moderation_action","currentActionCount","Number","currentActionCountTotal","setItem","onSub","_ref","actionNeed","onResub","_ref2","onSubGift","_ref3","connect","fetchData","_jsxs","fontFamily","fontSize","textAlign","verticalAlign","textShadow","margin","children","_jsx"],"sourceRoot":""}