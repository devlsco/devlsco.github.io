"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[393],{3393:function(e,t,i){i.r(t);var a=i(2791),n=i(1889),s=i(6377),r=i(7391),o=i(6151),l=i(8096),d=i(4925),c=i(8837),h=i(3786),u=i(890),f=i(4746),p=i(184);t.default=()=>{const[e,t]=(0,a.useState)(""),[i,m]=(0,a.useState)(""),[v,x]=(0,a.useState)(""),[g,j]=(0,a.useState)([]),[k,I]=(0,a.useState)(""),[_,Z]=(0,a.useState)(""),[w,y]=(0,a.useState)(null),[$,b]=(0,a.useState)([]),[S,C]=(0,a.useState)("");(0,a.useEffect)((()=>{document.title="LsCo Software - Channel Manager"}),[]);const P=()=>{const e=(JSON.parse(localStorage.getItem("tokens"))||[]).map((e=>{let{login:t,id:i}=e;return{value:i,label:`${t} - ID: ${i}`}}));e.length>=1?j(e):j([{value:"",label:"No Channels"}])},A=async e=>{if(""!==e.trim()){const t=await fetch(`https://api.twitch.tv/helix/search/channels?query=${e}`,{headers:{"Client-Id":"9uavest5z7knsvpbip19fxqkywxz3ec"}}),i=await t.json();t.ok?b(i.data.map((e=>`${e.display_name} - ID: ${e.id}`))):b([])}else b([])};(0,a.useEffect)((()=>{P()}),[]),(0,a.useEffect)((()=>{m(""),x("");const e=async()=>{if(!k)return m("No channel specified"),void x("");const e=JSON.parse(localStorage.getItem("tokens"))||[],t=e.findIndex((e=>e.id===k)),i=await fetch(`https://api.twitch.tv/helix/channels/vips?broadcaster_id=${e[t].id}&user_id=${S.split("- ID: ")[1]}`,{method:"DELETE",headers:{Authorization:`Bearer ${e[t].access_token}`,"Client-Id":e[t].client_id}});if(!i.ok){const e=await i.json();return m(e.message),void x("")}x(""),x(`Successfully removed ${S.split("- ID: ")[0]} as VIP in ${e[t].login}`)},t=async()=>{if(!k)return m("No channel specified"),void x("");const e=JSON.parse(localStorage.getItem("tokens"))||[],t=e.findIndex((e=>e.id===k)),i=await fetch(`https://api.twitch.tv/helix/moderation/moderators?broadcaster_id=${e[t].id}&user_id=${S.split("- ID: ")[1]}`,{method:"DELETE",headers:{Authorization:`Bearer ${e[t].access_token}`,"Client-Id":e[t].client_id}});if(!i.ok){const e=await i.json();return m(e.message),void x("")}x(""),x(`Successfully removed ${S.split("- ID: ")[0]} as Moderator in ${e[t].login}`)},i=async()=>{if(!k)return m("No channel specified"),void x("");const e=JSON.parse(localStorage.getItem("tokens"))||[],t=e.findIndex((e=>e.id===k)),i=await fetch(`https://api.twitch.tv/helix/channels/vips?broadcaster_id=${e[t].id}&user_id=${S.split("- ID: ")[1]}`,{method:"POST",headers:{Authorization:`Bearer ${e[t].access_token}`,"Client-Id":e[t].client_id}});if(!i.ok){const e=await i.json();return m(e.message),void x("")}x(""),x(`Successfully added ${S.split("- ID: ")[0]} as VIP in ${e[t].login}`)},l=async()=>{if(!k)return m("No channel specified"),void x("");const e=JSON.parse(localStorage.getItem("tokens"))||[],t=e.findIndex((e=>e.id===k)),i=await fetch(`https://api.twitch.tv/helix/moderation/moderators?broadcaster_id=${e[t].id}&user_id=${S.split("- ID: ")[1]}`,{method:"POST",headers:{Authorization:`Bearer ${e[t].access_token}`,"Client-Id":e[t].client_id}});if(!i.ok){const e=await i.json();return m(e.message),void x("")}x(""),x(`Successfully added ${S.split("- ID: ")[0]} as Moderator in ${e[t].login}`)};(async()=>{if("add-moderator"===_)y((0,p.jsxs)(a.Fragment,{children:[(0,p.jsx)(n.ZP,{item:!0,xs:12,children:(0,p.jsx)(s.Z,{options:$,onChange:(e,t)=>{C(t)},renderInput:e=>(0,p.jsx)(r.Z,{...e,fullWidth:!0,id:"standard-basic",label:"User",variant:"filled",onChange:e=>{A(e.target.value)}})})}),(0,p.jsx)(n.ZP,{item:!0,xs:12,children:(0,p.jsx)(o.Z,{variant:"contained",fullWidth:!0,onClick:l,children:"Add"})})]}));else if("add-vip"===_)y((0,p.jsxs)(a.Fragment,{children:[(0,p.jsx)(n.ZP,{item:!0,xs:12,children:(0,p.jsx)(s.Z,{options:$,onChange:(e,t)=>{C(t)},renderInput:e=>(0,p.jsx)(r.Z,{...e,fullWidth:!0,id:"standard-basic",label:"User",variant:"filled",onChange:e=>{A(e.target.value)}})})}),(0,p.jsx)(n.ZP,{item:!0,xs:12,children:(0,p.jsx)(o.Z,{variant:"contained",fullWidth:!0,onClick:i,children:"Add"})})]}));else if("remove-moderator"===_){const e={options:await(async()=>{if(!k)return m("No channel specified"),x(""),[];const e=JSON.parse(localStorage.getItem("tokens"))||[],t=e.findIndex((e=>e.id===k));let i=`https://api.twitch.tv/helix/moderation/moderators?first=100&broadcaster_id=${e[t].id}`,a=null,n=[];for(;;){a&&(i=`https://api.twitch.tv/helix/moderation/moderators?first=100&broadcaster_id=${e[t].id}&after=${a}`);const s=await fetch(i,{headers:{Authorization:`Bearer ${e[t].access_token}`,"Client-Id":e[t].client_id}}),r=await s.json();if(!s.ok)return[];if(n.push(...r.data.map((e=>`${e.user_name} - ID: ${e.user_id}`))),!r.pagination||!r.pagination.cursor)break;a=r.pagination.cursor}return n})()};y((0,p.jsxs)(a.Fragment,{children:[(0,p.jsx)(n.ZP,{item:!0,xs:12,children:(0,p.jsx)(s.Z,{...e,id:"disable-close-on-select",onChange:(e,t)=>{C(t)},renderInput:e=>(0,p.jsx)(r.Z,{...e,label:"Moderator",variant:"filled"})})}),(0,p.jsx)(n.ZP,{item:!0,xs:12,children:(0,p.jsx)(o.Z,{variant:"contained",fullWidth:!0,onClick:t,children:"Remove"})})]}))}else if("remove-vip"===_){const t={options:await(async()=>{if(!k)return m("No channel specified"),x(""),[];const e=JSON.parse(localStorage.getItem("tokens"))||[],t=e.findIndex((e=>e.id===k));let i=`https://api.twitch.tv/helix/channels/vips?first=100&broadcaster_id=${e[t].id}`,a=null,n=[];for(;;){a&&(i=`https://api.twitch.tv/helix/channels/vips?first=100&broadcaster_id=${e[t].id}&after=${a}`);const s=await fetch(i,{headers:{Authorization:`Bearer ${e[t].access_token}`,"Client-Id":e[t].client_id}}),r=await s.json();if(!s.ok)return[];if(n.push(...r.data.map((e=>`${e.user_name} - ID: ${e.user_id}`))),!r.pagination||!r.pagination.cursor)break;a=r.pagination.cursor}return n})()};y((0,p.jsxs)(a.Fragment,{children:[(0,p.jsxs)(n.ZP,{item:!0,xs:12,children:[(0,p.jsx)(s.Z,{...t,id:"disable-close-on-select",onChange:(e,t)=>{C(t)},renderInput:e=>(0,p.jsx)(r.Z,{...e,label:"VIP",variant:"filled"})})," "]}),(0,p.jsx)(n.ZP,{item:!0,xs:12,children:(0,p.jsx)(o.Z,{variant:"contained",fullWidth:!0,onClick:e,children:"Remove"})})]}))}})()}),[_,$,k,S]);const N=async e=>{const t=await fetch("https://id.twitch.tv/oauth2/validate",{headers:{Authorization:`OAuth ${e}`}}),i=await t.json();if(!t.ok){if("invalid access token"===i.message)throw new Error("Invalid access token");throw new Error(i.message||"Validate token failed")}return i};return(0,p.jsx)(f.Z,{title:"Channel Manager",description:"Add or remove moderators/VIPs from a specific channel.",children:(0,p.jsxs)(n.ZP,{container:!0,spacing:2,alignItems:"center",children:[(0,p.jsx)(n.ZP,{item:!0,xs:12,children:(0,p.jsx)(r.Z,{fullWidth:!0,id:"standard-basic",label:"OAuth Token",type:"password",value:e,variant:"filled",onChange:e=>t(e.target.value)})}),(0,p.jsx)(n.ZP,{item:!0,xs:6,children:(0,p.jsx)(o.Z,{variant:"contained",style:{background:"#2196f3"},fullWidth:!0,onClick:async()=>{if(""===e.trim())return m("You must specify an OAuth Token"),void x("");try{const t=JSON.parse(localStorage.getItem("tokens"))||[],i=await N(e.replace(/^oauth[:]*/i,""));return t.find((e=>e.id===i.user_id.toLowerCase()))?(m("The channel already exists"),void x("")):(t.push({id:i.user_id,login:i.login,access_token:e.replace(/^oauth[:]*/i,""),client_id:i.client_id}),localStorage.setItem("tokens",JSON.stringify(t)),P(),x(""),void x(`Successfully added login: ${i.login} - ID: ${i.user_id}`))}catch(t){return m(t.message),void x("")}},children:"Add"})}),(0,p.jsx)(n.ZP,{item:!0,xs:6,children:(0,p.jsx)(o.Z,{variant:"contained",style:{background:"#ff0000"},fullWidth:!0,onClick:async()=>{if(!k)return m("No channel specified"),void x("");try{const e=localStorage.getItem("tokens")?JSON.parse(localStorage.getItem("tokens")):[],t=e.findIndex((e=>e.id===k));if(-1===t)return m("There are no channels"),void x("");const i=e[t];return e.splice(t,1),localStorage.setItem("tokens",JSON.stringify(e)),P(),x(""),void x(`Successfully removed login: ${i.login} - ID: ${i.id}`)}catch(e){return m(e.message),void x("")}},children:"Remove"})}),(0,p.jsx)(n.ZP,{item:!0,xs:12,children:(0,p.jsx)(o.Z,{variant:"contained",style:{background:"hsla(0, 0%, 40%, .3)",border:"1px solid #2196f3"},fullWidth:!0,onClick:async()=>{var e;const t=null!==(e=window.location.origin)&&void 0!==e?e:"https://devlsco.github.io/";window.open(`https://id.twitch.tv/oauth2/authorize?response_type=token&client_id=87q7zikx7uny69x0wkxtf8bm4kd5m2&redirect_uri=${t}&scope=channel:manage:vips+channel:manage:moderators&force_verify=true`,"_self")},children:"Generate OAuth Token"})}),(0,p.jsx)(n.ZP,{item:!0,xs:6,children:(0,p.jsxs)(l.Z,{fullWidth:!0,variant:"filled",children:[(0,p.jsx)(d.Z,{id:"channel-label",children:"Channel"}),(0,p.jsx)(c.Z,{value:k,onChange:e=>I(e.target.value),labelId:"channel-label",id:"channel-select",children:g.map(((e,t)=>(0,p.jsx)(h.Z,{value:e.value,selected:1===t,children:e.label},e.value)))})]})}),(0,p.jsx)(n.ZP,{item:!0,xs:6,children:(0,p.jsxs)(l.Z,{fullWidth:!0,variant:"filled",children:[(0,p.jsx)(d.Z,{id:"type-label",children:"Type"}),(0,p.jsxs)(c.Z,{value:_,onChange:e=>Z(e.target.value),labelId:"type-label",id:"type-select",children:[(0,p.jsx)(h.Z,{value:"add-moderator",children:"Add Moderator"}),(0,p.jsx)(h.Z,{value:"add-vip",children:"Add VIP"}),(0,p.jsx)(h.Z,{value:"remove-moderator",children:"Remove Moderator"}),(0,p.jsx)(h.Z,{value:"remove-vip",children:"Remove VIP"})]})]})}),w,(0,p.jsxs)(n.ZP,{item:!0,xs:12,children:[i&&(0,p.jsx)(u.Z,{variant:"body2",style:{color:"red",marginTop:"10px",textAlign:"center"},children:i}),v&&(0,p.jsx)(u.Z,{variant:"body2",style:{marginTop:"10px",textAlign:"center"},children:v})]})]})})}}}]);
//# sourceMappingURL=393.3183453a.chunk.js.map