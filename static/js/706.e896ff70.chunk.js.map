{"version":3,"file":"static/js/706.e896ff70.chunk.js","mappings":"wKA8EA,UA5EaA,MACXC,EAAAA,EAAAA,YAAU,KACUC,WAChB,IACE,MACMC,EADY,IAAIC,gBAAgBC,OAAOC,SAASC,KAAKC,UAAU,IACvCC,IAAI,gBAElC,GAAIN,EAAa,CACf,MAAMO,QAAiBC,EAAcR,GAC/BS,QAAaC,EAAQH,EAASI,QAASX,EAAaO,EAASK,WAE7DC,EAAY,CAChBC,aAAcd,EACdY,UAAWL,EAASK,UACpBG,GAAIN,EAAKM,GACTC,MAAOP,EAAKO,MACZC,YAAaR,EAAKQ,YAClBC,kBAAmBT,EAAKS,mBAG1BC,aAAaC,QAAQ,QAASC,KAAKC,UAAUT,IAE7CX,OAAOqB,KAAM,GAAErB,OAAOC,SAASqB,mBAAoB,QACrD,MACEtB,OAAOqB,KAAM,GAAErB,OAAOC,SAASqB,mBAAoB,QAIvD,CAFE,MAAOC,GACPC,QAAQC,MAAMF,EAChB,GAGFG,EAAW,GACV,IAEH,MAAMpB,EAAgBT,UACpB,IACE,MAAM8B,QAAyBC,MAAM,uCAAwC,CAC3EC,QAAS,CACPC,cAAgB,UAASC,OAI7B,IAAKJ,EAAiBK,GACpB,MAAM,IAAIC,MAAM,wBAIlB,aAD2BN,EAAiBO,MAI9C,CAFE,MAAOX,GACPC,QAAQC,MAAMF,EAChB,GAGIf,EAAUX,MAAOgB,EAAIf,EAAaY,KACtC,IACE,MAAMyB,QAAiBP,MAAO,wCAAuCf,IAAM,CACzEgB,QAAS,CACPC,cAAe,UAAYhC,EAC3B,YAAaY,KAIjB,IAAKyB,EAASH,GACZ,MAAM,IAAIC,MAAM,sBAIlB,aADmBE,EAASD,QAChB3B,KAAK,EAGnB,CAFE,MAAOgB,GACPC,QAAQC,MAAMF,EAChB,GAGF,OAAO,IAAI,C","sources":["views/callback/index.js"],"sourcesContent":["import { useEffect } from 'react';\r\n\r\nconst Page = () => {\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const urlParams = new URLSearchParams(window.location.hash.substring(1));\r\n        const accessToken = urlParams.get('access_token');\r\n\r\n        if (accessToken) {\r\n          const validate = await validateToken(accessToken);\r\n          const data = await getUser(validate.user_id, accessToken, validate.client_id);\r\n\r\n          const loginData = {\r\n            access_token: accessToken,\r\n            client_id: validate.client_id,\r\n            id: data.id,\r\n            login: data.login,\r\n            description: data.description,\r\n            profile_image_url: data.profile_image_url\r\n          };\r\n\r\n          localStorage.setItem('login', JSON.stringify(loginData));\r\n\r\n          window.open(`${window.location.origin}/dashboard`, '_self');\r\n        } else {\r\n          window.open(`${window.location.origin}/dashboard`, '_self');\r\n        }\r\n      } catch (err) {\r\n        console.error(err);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  const validateToken = async (token) => {\r\n    try {\r\n      const validateResponse = await fetch('https://id.twitch.tv/oauth2/validate', {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      if (!validateResponse.ok) {\r\n        throw new Error('Invalid access token');\r\n      }\r\n\r\n      const validateData = await validateResponse.json();\r\n      return validateData;\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const getUser = async (id, accessToken, client_id) => {\r\n    try {\r\n      const response = await fetch(`https://api.twitch.tv/helix/users?id=${id}`, {\r\n        headers: {\r\n          Authorization: 'Bearer ' + accessToken,\r\n          'Client-ID': client_id\r\n        }\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Error getting user');\r\n      }\r\n\r\n      const data = await response.json();\r\n      return data.data[0];\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  return null;\r\n};\r\n\r\nexport default Page;\r\n"],"names":["Page","useEffect","async","accessToken","URLSearchParams","window","location","hash","substring","get","validate","validateToken","data","getUser","user_id","client_id","loginData","access_token","id","login","description","profile_image_url","localStorage","setItem","JSON","stringify","open","origin","err","console","error","fetchData","validateResponse","fetch","headers","Authorization","token","ok","Error","json","response"],"sourceRoot":""}