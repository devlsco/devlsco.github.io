{"version":3,"file":"static/js/419.c36c6a1c.chunk.js","mappings":"qMAIA,MAAMA,EAAS,IAAIC,EAAAA,EAAW,CAAEC,SAAU,CAAC,IAAIC,gBAAgBC,OAAOC,SAASC,QAAQC,IAAI,YACrFC,EAAS,IAAIC,EAAAA,EAEnB,SAASC,EAAOC,GACd,OAAOA,EAAOC,WAAWC,QAAQ,wBAAyB,IAC5D,CA8GA,UAlGaC,KAAO,IAADC,EAAAC,EAAAC,EACjB,MAAOC,EAAkBC,IAAuBC,EAAAA,EAAAA,UAA2D,QAAnDL,EAACM,aAAaC,QAAQ,qCAA6B,IAAAP,EAAAA,EAAI,IACxGQ,EAAiBC,IAAsBJ,EAAAA,EAAAA,UAA8C,QAAtCJ,EAACK,aAAaC,QAAQ,wBAAgB,IAAAN,EAAAA,EAAI,IAEhGS,EAAAA,EAAAA,YAAU,MACRC,iBACEC,SAASC,MAAQ,mCACjBD,SAASE,KAAKC,MAAMC,gBAAkB,qBAEtC,MAAMC,EAAY,IAAI7B,gBAAgBC,OAAOC,SAASC,QAAQC,IAAI,gBAC5D0B,EAAW,IAAI9B,gBAAgBC,OAAOC,SAASC,QAAQC,IAAI,SAC3D2B,EAAS,IAAI/B,gBAAgBC,OAAOC,SAASC,QAAQC,IAAI,MAGzD4B,QAxBQT,OAAOU,EAAOC,KAChC,MAAMC,QAAgBC,MAAM,0CAA4CH,GAExE,OAAKE,EAAQE,GAIN,WAFYF,EAAQG,QAEXC,WAAWC,KAAKC,GAAMA,EAAEP,KAAKA,GAJrB,EAIwB,EAerBQ,CAAYZ,EAAUC,IAErBS,KAAKC,GAAO,0BAAyBV,KAAUU,MAEvEpC,EAAOsC,cAAa,CAACC,EAASC,KAC5BC,QAAQC,IAAI,wBAAyBF,EAAO,IAG9CxC,EAAO2C,eAAc,CAACC,EAAOC,KAC3BJ,QAAQI,MAAO,4CAA2CD,MAAWC,EAAM,IAG7E7C,EAAO8C,WAAU5B,UACfuB,QAAQC,IAAI,4BACN1C,EAAO+C,OAAOpB,EAAQH,EAAU,IAGxCxB,EAAOgD,WAAU9B,MAAO0B,EAAOK,KAC7B,GAAiC,2BAA7BL,EAAMM,MAAM,KAAKC,SACfF,EAAQG,KAAKC,qBAAuB3B,EACtC,OAAQuB,EAAQG,KAAKE,mBACnB,IAAK,SACL,IAAK,UACL,IAAK,MAAO,CACV,MAAMC,EAAqBC,OAAO3C,aAAaC,QAAQ,+BAAiC,EACxFD,aAAa4C,QAAQ,6BAA8BF,GACnD5C,EAAoB4C,GACpB,KACF,EAKN,IAGF/D,EAAOkE,OAAM,KACX,MAAM3C,EAAkByC,OAAO3C,aAAaC,QAAQ,kBAAoB,EACxED,aAAa4C,QAAQ,gBAAiB1C,GACtCC,EAAmBD,EAAgB,IAGrCvB,EAAOmE,SAAQ,KACb,MAAM5C,EAAkByC,OAAO3C,aAAaC,QAAQ,kBAAoB,EACxED,aAAa4C,QAAQ,gBAAiB1C,GACtCC,EAAmBD,EAAgB,IAGrCvB,EAAOoE,WAAU,KACf,MAAM7C,EAAkByC,OAAO3C,aAAaC,QAAQ,kBAAoB,EACxED,aAAa4C,QAAQ,gBAAiB1C,GACtCC,EAAmBD,GACnB0B,QAAQC,IAAI,YAAY,IAG1B1C,EAAO6D,UACPrE,EAAOqE,SAMT,CAEAC,EAAW,GACV,IAEH,MAAMC,EAAY,IAAIpE,gBAAgBC,OAAOC,SAASC,QAEtD,OACEkE,EAAAA,EAAAA,MAAA,OACE1C,MAAO,CACL2C,WAAY,aACZC,SAAU,WACVC,UAAW,MACXC,cAAe,SACfC,WAAY,iCACZC,OAAQ,UACRC,SAAA,CACH,SACQrE,EAAOa,GAAiB,mBAAiBb,EAAOQ,GAAkB,IACxER,EAAOsD,OAAOzC,IAA4C,QAA5BN,EAAIsD,EAAUhE,IAAI,kBAAU,IAAAU,EAAAA,EAAI,MAC3D,C","sources":["views/marathon/modding/index.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { BasicPubSubClient } from '@twurple/pubsub';\r\nimport { ChatClient } from '@twurple/chat';\r\n\r\nconst client = new ChatClient({ channels: [new URLSearchParams(window.location.search).get('login')] });\r\nconst pubsub = new BasicPubSubClient();\r\n\r\nfunction format(number) {\r\n  return number.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.');\r\n}\r\n\r\nconst getChannels = async (login, id) => {\r\n  const request = await fetch('https://api.modscanner.com/twitch/user/' + login);\r\n\r\n  if (!request.ok) return [];\r\n\r\n  const data = await request.json();\r\n\r\n  return [...data.moderating.map((i) => i.id), id];\r\n};\r\n\r\nconst Page = () => {\r\n  const [moderationAction, setModerationAction] = useState(localStorage.getItem('marathon_moderation_action') ?? 0);\r\n  const [currentSubCount, setCurrentSubCount] = useState(localStorage.getItem('marathon_subs') ?? 0);\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      document.title = 'LsCo Software - Modding Marathon';\r\n      document.body.style.backgroundColor = 'initial !important';\r\n\r\n      const authToken = new URLSearchParams(window.location.search).get('access_token');\r\n      const username = new URLSearchParams(window.location.search).get('login');\r\n      const userID = new URLSearchParams(window.location.search).get('id');\r\n      const channels = await getChannels(username, userID);\r\n\r\n      const topics = channels.map((i) => `chat_moderator_actions.${userID}.${i}`);\r\n\r\n      pubsub.onDisconnect((isError, reason) => {\r\n        console.log('[PubSub] Disconnected', reason);\r\n      });\r\n\r\n      pubsub.onListenError((topic, error) => {\r\n        console.error(`[PubSub] An error has occurred on topic '${topic}':`, error);\r\n      });\r\n\r\n      pubsub.onConnect(async () => {\r\n        console.log('[PubSub] Connected');\r\n        await pubsub.listen(topics, authToken);\r\n      });\r\n\r\n      pubsub.onMessage(async (topic, message) => {\r\n        if (topic.split('.').shift() === 'chat_moderator_actions') {\r\n          if (message.data.created_by_user_id === userID) {\r\n            switch (message.data.moderation_action) {\r\n              case 'delete':\r\n              case 'timeout':\r\n              case 'ban': {\r\n                const currentActionCount = Number(localStorage.getItem('marathon_moderation_action')) + 1;\r\n                localStorage.setItem('marathon_moderation_action', currentActionCount);\r\n                setModerationAction(currentActionCount);\r\n                break;\r\n              }\r\n              default:\r\n                break;\r\n            }\r\n          }\r\n        }\r\n      });\r\n\r\n      client.onSub(() => {\r\n        const currentSubCount = Number(localStorage.getItem('marathon_subs')) + 1;\r\n        localStorage.setItem('marathon_subs', currentSubCount);\r\n        setCurrentSubCount(currentSubCount);\r\n      });\r\n\r\n      client.onResub(() => {\r\n        const currentSubCount = Number(localStorage.getItem('marathon_subs')) + 1;\r\n        localStorage.setItem('marathon_subs', currentSubCount);\r\n        setCurrentSubCount(currentSubCount);\r\n      });\r\n\r\n      client.onSubGift(() => {\r\n        const currentSubCount = Number(localStorage.getItem('marathon_subs')) + 1;\r\n        localStorage.setItem('marathon_subs', currentSubCount);\r\n        setCurrentSubCount(currentSubCount);\r\n        console.log('onSubGift');\r\n      });\r\n\r\n      pubsub.connect();\r\n      client.connect();\r\n\r\n      return () => {\r\n        pubsub.disconnect();\r\n        client.disconnect();\r\n      };\r\n    }\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  const URLParams = new URLSearchParams(window.location.search);\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        fontFamily: 'Comic Neue',\r\n        fontSize: 'xx-large',\r\n        textAlign: 'end',\r\n        verticalAlign: 'middle',\r\n        textShadow: '4px 4px 6px rgba(0, 0, 0, 0.4)',\r\n        margin: '2.5rem'\r\n      }}\r\n    >\r\n      Subs: {format(currentSubCount)} - Mod Actions: {format(moderationAction)}/\r\n      {format(Number(currentSubCount) * (URLParams.get('countup') ?? 5))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Page;\r\n"],"names":["client","ChatClient","channels","URLSearchParams","window","location","search","get","pubsub","BasicPubSubClient","format","number","toString","replace","Page","_localStorage$getItem","_localStorage$getItem2","_URLParams$get","moderationAction","setModerationAction","useState","localStorage","getItem","currentSubCount","setCurrentSubCount","useEffect","async","document","title","body","style","backgroundColor","authToken","username","userID","topics","login","id","request","fetch","ok","json","moderating","map","i","getChannels","onDisconnect","isError","reason","console","log","onListenError","topic","error","onConnect","listen","onMessage","message","split","shift","data","created_by_user_id","moderation_action","currentActionCount","Number","setItem","onSub","onResub","onSubGift","connect","fetchData","URLParams","_jsxs","fontFamily","fontSize","textAlign","verticalAlign","textShadow","margin","children"],"sourceRoot":""}